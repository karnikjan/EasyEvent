(this.webpackJsonpfrontend=this.webpackJsonpfrontend||[]).push([[0],{21:function(e,t,n){e.exports=n(42)},26:function(e,t,n){},27:function(e,t,n){},28:function(e,t,n){},29:function(e,t,n){},30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),r=n(17),i=n.n(r),c=(n(26),n(2)),l=n(8),u=n(6),s=(n(27),o.a.createContext({token:null,userId:null,login:function(e,t,n){},logout:function(){}})),m=function(e){var t=Object(a.useState)(!0),n=Object(c.a)(t,2),r=n[0],i=n[1],l=Object(a.useRef)(),u=Object(a.useRef)(),m=Object(a.useContext)(s);return o.a.createElement("form",{className:"auth-form",onSubmit:function(e){e.preventDefault();var t=l.current.value,n=u.current.value;if(0!==t.trim().length&&0!==n.trim().length){var a={query:"\n                query Login($email: String!, $password: String!) {\n                    login(email: $email, password: $password) {\n                        userId\n                        token\n                        tokenExpiration\n                    }\n                }\n            ",variables:{email:t,password:n}};r||(a={query:"\n                    mutation CreateUser($email: String!, $password: String!) {\n                        createUser(userInput: {email: $email, password: $password}) {\n                            _id\n                            email\n                        }\n                    }\n                ",variables:{email:t,password:n}}),fetch("http://localhost:".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT,"/graphql"),{method:"POST",body:JSON.stringify(a),headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");return e.json()})).then((function(e){e.data.login.token&&m.login(e.data.login.token,e.data.login.userId,e.data.login.tokenExpiration)})).catch((function(e){console.log(e)}))}}},o.a.createElement("h1",null,r?"Login":"Sign Up"),o.a.createElement("div",{className:"form-control"},o.a.createElement("label",{htmlFor:"email"},"E-mail"),o.a.createElement("input",{type:"email",id:"email",ref:l})),o.a.createElement("div",{className:"form-control"},o.a.createElement("label",{htmlFor:"password"},"Password"),o.a.createElement("input",{type:"password",id:"password",ref:u})),o.a.createElement("div",{className:"form-actions"},o.a.createElement("button",{type:"submit"},"Submit"),o.a.createElement("button",{type:"button",onClick:function(){i((function(e){return!e}))}},"Switch to ",r?"Sign Up":"Login")))},d=n(20),E=(n(28),function(e){return o.a.createElement("div",{className:"modal"},o.a.createElement("header",{className:"modal__header"},o.a.createElement("h1",null,e.title)),o.a.createElement("section",{className:"modal__content"},e.children),o.a.createElement("section",{className:"modal__actions"},e.canCancel&&o.a.createElement("button",{className:"btn",onClick:e.onCancel},"Cancel"),e.canConfirm&&o.a.createElement("button",{className:"btn",onClick:e.onConfirm},e.confirmText)))}),f=(n(29),function(e){return o.a.createElement("div",{className:"backdrop"})}),p=(n(30),function(e){return o.a.createElement("li",{key:e.eventId,className:"events__list-item"},o.a.createElement("div",null,o.a.createElement("h1",null,e.title),o.a.createElement("h2",null,"$",e.price," - ",new Date(e.date).toLocaleDateString("cz-CZ"))),o.a.createElement("div",null,e.userId===e.creatorId?o.a.createElement("p",null,"You're the owner of this event."):o.a.createElement("button",{className:"btn",onClick:e.onDetail.bind(void 0,e.eventId)},"View Details")))}),v=(n(31),function(e){var t=e.events.map((function(t){return o.a.createElement(p,{key:t._id,eventId:t._id,title:t.title,price:t.price,date:t.date,userId:e.authUserId,creatorId:t.creator._id,onDetail:e.onViewDetail})}));return o.a.createElement("ul",{className:"event__list"},t)}),h=(n(32),function(){return o.a.createElement("div",{className:"spinner"},o.a.createElement("div",{className:"lds-circle"},o.a.createElement("div",null)))}),b=(n(33),function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),l=Object(c.a)(i,2),u=l[0],m=l[1],p=Object(a.useState)(!1),b=Object(c.a)(p,2),O=b[0],_=b[1],S=Object(a.useState)(null),g=Object(c.a)(S,2),C=g[0],T=g[1],N=!0;Object(a.useEffect)((function(){return R(),function(){N=!1}}),[]);var j=Object(a.useContext)(s),k=j.token,D=Object(a.useRef)(),y=Object(a.useRef)(),w=Object(a.useRef)(),P=Object(a.useRef)(),I=function(){r(!1),T(null)},R=function(){_(!0);fetch("http://localhost:".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT,"/graphql"),{method:"POST",body:JSON.stringify({query:"\n                query {\n                    events {\n                        _id\n                        title\n                        description\n                        date\n                        price\n                        creator {\n                            _id\n                            email\n                        }\n                    }\n                }\n            "}),headers:{"Content-Type":"application/json"}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");return e.json()})).then((function(e){var t=e.data.events;N&&(m(t),_(!1))})).catch((function(e){console.log(e),N&&_(!1)}))};return o.a.createElement(o.a.Fragment,null,(n||C)&&o.a.createElement(f,null),n&&o.a.createElement(E,{title:"Add Event",canCancel:!0,canConfirm:!0,onCancel:I,onConfirm:function(){r(!1);var e=D.current.value,t=+y.current.value,n=w.current.value,a=P.current.value;if(!(0===e.trim().length||t<=0||0===n.trim().length||0===a.trim().length)){var o={query:"\n                mutation CreateEvent($title: String!, $description: String!, $price: Float!, $date: String!) {\n                    createEvent(eventInput: {title: $title, description: $description, price: $price, date: $date}) {\n                        _id\n                        title\n                        description\n                        date\n                        price\n                    }\n                }\n            ",variables:{title:e,description:a,price:t,date:n}};fetch("http://localhost:".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT,"/graphql"),{method:"POST",body:JSON.stringify(o),headers:{"Content-Type":"application/json",Authorization:"Bearer "+k}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");return e.json()})).then((function(e){m((function(t){var n=Object(d.a)(t);return n.push({_id:e.data.createEvent._id,title:e.data.createEvent.title,description:e.data.createEvent.description,date:e.data.createEvent.date,price:e.data.createEvent.price,creator:{_id:j.userId}}),n}))})).catch((function(e){console.log(e)}))}},confirmText:"Confirm"},o.a.createElement("form",null,o.a.createElement("div",{className:"form-control"},o.a.createElement("label",{htmlFor:"title"},"Title"),o.a.createElement("input",{type:"text",id:"title",ref:D})),o.a.createElement("div",{className:"form-control"},o.a.createElement("label",{htmlFor:"price"},"Price"),o.a.createElement("input",{type:"number",id:"price",ref:y})),o.a.createElement("div",{className:"form-control"},o.a.createElement("label",{htmlFor:"date"},"Date"),o.a.createElement("input",{type:"datetime-local",id:"date",ref:w})),o.a.createElement("div",{className:"form-control"},o.a.createElement("label",{htmlFor:"description"},"Description"),o.a.createElement("textarea",{id:"description",rows:"4",ref:P})))),C&&o.a.createElement(E,{title:C.title,canCancel:!0,canConfirm:!0,onCancel:I,onConfirm:function(){if(k){var e={query:"\n                mutation BookEvent($id: ID!) {\n                    bookEvent(eventId: $id) {\n                        _id\n                        createdAt\n                        updatedAt\n                    }\n                }\n            ",variables:{id:C._id}};fetch("http://localhost:".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT,"/graphql"),{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json",Authorization:"Bearer "+k}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");return e.json()})).then((function(e){console.log(e),T(null)})).catch((function(e){console.log(e)}))}else T(null)},confirmText:j.token?"Book":"Confirm"},o.a.createElement("h1",null,C.title),o.a.createElement("h2",null,"$",C.price," - ",new Date(C.date).toLocaleDateString("cz-CZ")),o.a.createElement("p",null,C.description)),j.token&&o.a.createElement("div",{className:"events-control"},o.a.createElement("p",null,"Share your own Events!"),o.a.createElement("button",{className:"btn",onClick:function(){r(!0)}},"Create Event")),O?o.a.createElement(h,null):o.a.createElement(v,{events:u,authUserId:j.userId,onViewDetail:function(e){T((function(t){return u.find((function(t){return t._id===e}))}))}}))}),O=(n(34),function(e){return o.a.createElement("ul",{className:"bookings__list"},e.bookings.map((function(t){return o.a.createElement("li",{key:t._id,className:"bookings__item"},o.a.createElement("div",{className:"bookings__item-data"},t.event.title," - "," ",new Date(t.createdAt).toLocaleDateString()),o.a.createElement("div",{className:"bookings__item-actions"},o.a.createElement("button",{className:"btn",onClick:e.onDelete.bind(void 0,t._id)},"Cancel")))})))}),_=function(){var e=Object(a.useState)(!1),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)([]),l=Object(c.a)(i,2),u=l[0],m=l[1],d=Object(a.useContext)(s);Object(a.useEffect)((function(){E()}),[]);var E=function(){r(!0);fetch("http://localhost:".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT,"/graphql"),{method:"POST",body:JSON.stringify({query:"\n                query {\n                    bookings {\n                        _id\n                        createdAt\n                        event {\n                            _id\n                            title\n                            date\n                        }\n                    }\n                }\n            "}),headers:{"Content-Type":"application/json",Authorization:"Bearer "+d.token}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");return e.json()})).then((function(e){var t=e.data.bookings;m(t),r(!1)})).catch((function(e){console.log(e),r(!1)}))};return o.a.createElement(o.a.Fragment,null,n?o.a.createElement(h,null):o.a.createElement(O,{bookings:u,onDelete:function(e){r(!0);var t={query:"\n                mutation CancelBooking($id: ID!) {\n                    cancelBooking(bookingId: $id) {\n                        _id\n                        title\n                    }\n                }\n            ",variables:{id:e}};fetch("http://localhost:".concat(Object({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0}).PORT,"/graphql"),{method:"POST",body:JSON.stringify(t),headers:{"Content-Type":"application/json",Authorization:"Bearer "+d.token}}).then((function(e){if(200!==e.status&&201!==e.status)throw new Error("Failed!");return e.json()})).then((function(t){m((function(t){return t.filter((function(t){return t._id!==e}))})),r(!1)})).catch((function(e){console.log(e),r(!1)}))}}))},S=(n(35),function(e){return o.a.createElement(s.Consumer,null,(function(e){return o.a.createElement("header",{className:"main-navigation"},o.a.createElement("div",{className:"main-navigation__logo"},o.a.createElement("h1",null,"EasyEvent")),o.a.createElement("nav",{className:"main-navigation__items"},o.a.createElement("ul",null,!e.token&&o.a.createElement("li",null,o.a.createElement(l.b,{to:"/auth"},"Authenticate")),o.a.createElement("li",null,o.a.createElement(l.b,{to:"/events"},"Events")),e.token&&o.a.createElement(o.a.Fragment,null,o.a.createElement("li",null,o.a.createElement(l.b,{to:"/bookings"},"Bookings")),o.a.createElement("li",null,o.a.createElement("button",{onClick:e.logout},"Logout"))))))}))}),g=(n(41),function(){var e=Object(a.useState)(null),t=Object(c.a)(e,2),n=t[0],r=t[1],i=Object(a.useState)(null),d=Object(c.a)(i,2),E=d[0],f=d[1];return o.a.createElement(l.a,null,o.a.createElement(s.Provider,{value:{token:n,userId:E,login:function(e,t,n){r(e),f(t)},logout:function(){r(null),f(null)}}},o.a.createElement(S,null),o.a.createElement("main",{className:"main-content"},o.a.createElement(u.d,null,n&&o.a.createElement(u.a,{from:"/",to:"/events",exact:!0}),n&&o.a.createElement(u.a,{from:"/auth",to:"/events",exact:!0}),!n&&o.a.createElement(u.b,{path:"/auth",component:m}),o.a.createElement(u.b,{path:"/events",component:b}),n&&o.a.createElement(u.b,{path:"/bookings",component:_}),!n&&o.a.createElement(u.a,{to:"/auth",exact:!0})))))});i.a.render(o.a.createElement(g,null),document.getElementById("root"))}},[[21,1,2]]]);
//# sourceMappingURL=main.451a0374.chunk.js.map